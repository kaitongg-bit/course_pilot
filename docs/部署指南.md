# éƒ¨ç½²æŒ‡å—

## ğŸš€ æ··åˆ RAG æ¶æ„

è¿™ä¸ªåç«¯å·²ç»å®Œå…¨é‡æ„ä¸ºä½¿ç”¨ **æ··åˆ RAG** (æ£€ç´¢å¢å¼ºç”Ÿæˆ) ç³»ç»Ÿ:

### æ¶æ„ç»„ä»¶

1. **å‘é‡æœç´¢ (70% æƒé‡)** - ChromaDB + Sentence Transformers
   - æ¨¡å‹: `all-MiniLM-L6-v2` (384 ç»´åµŒå…¥)
   - æŒä¹…åŒ–å­˜å‚¨åœ¨ `backend/chroma_db/`
   - ä½™å¼¦ç›¸ä¼¼åº¦è¿›è¡Œè¯­ä¹‰åŒ¹é…

2. **å…³é”®è¯åŒ¹é… (30% æƒé‡)**
   - ç²¾ç¡®è¯¾ç¨‹ ID åŒ¹é… (ä¾‹å¦‚ "15-112")
   - éƒ¨åˆ† ID åŒ¹é…æƒé‡é™ä½
   - ç¡®ä¿ç‰¹å®šè¯¾ç¨‹æŸ¥è¯¢è¿”å›æ­£ç¡®ç»“æœ

3. **LLM ç”Ÿæˆ** - Groq API
   - æ¨¡å‹: `llama-3.1-70b-versatile`
   - å¿«é€Ÿæ¨ç†ç”Ÿæˆè¯¾ç¨‹æ‘˜è¦
   - è¯„è®ºå†…å®¹å®¡æ ¸

### æ··åˆæœç´¢å…¬å¼

```
æœ€ç»ˆåˆ†æ•° = (å‘é‡ç›¸ä¼¼åº¦ Ã— 0.7) + (å…³é”®è¯åŒ¹é… Ã— 0.3)
```

**ä¸ºä»€ä¹ˆæœ‰æ•ˆ:**
- å‘é‡æœç´¢æ•è·è¯­ä¹‰å«ä¹‰ ("æœºå™¨å­¦ä¹ " åŒ¹é… "ML"ã€"AI"ã€"ç¥ç»ç½‘ç»œ")
- å…³é”®è¯åŒ¹é…ç¡®ä¿ç²¾ç¡®è¯¾ç¨‹ ID ä¼˜å…ˆ
- æ—¶é—´è¡¨è¿‡æ»¤åœ¨æ£€ç´¢åè¿›è¡Œä»¥æé«˜æ•ˆç‡

---

## ğŸ“¦ æœ¬åœ°æµ‹è¯•

### 1. å®‰è£…ä¾èµ–

```bash
cd backend
pip install -r requirements.txt
```

### 2. è®¾ç½®ç¯å¢ƒå˜é‡

ä½ çš„ Groq API å¯†é’¥:
```bash
export GROQ_API_KEY="your_groq_api_key_here"
export PORT=8080
```

è·å– Groq API å¯†é’¥: https://console.groq.com/keys

### 3. æœ¬åœ°è¿è¡Œ

```bash
cd backend
python llm-proxy.py
```

æœåŠ¡å™¨å°†:
1. åˆå§‹åŒ– ChromaDB (é¦–æ¬¡è¿è¡Œä¼šç´¢å¼•æ‰€æœ‰è¯¾ç¨‹ - éœ€è¦çº¦ 30 ç§’)
2. åŠ è½½è¯¾ç¨‹å’Œè¯„è®ºæ•°æ®
3. åˆå§‹åŒ– Groq å®¢æˆ·ç«¯
4. åœ¨ `http://0.0.0.0:8080` å¯åŠ¨ Flask æœåŠ¡å™¨

### 4. æµ‹è¯• API

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/health

# è¯¾ç¨‹åŒ¹é…
curl -X POST http://localhost:8080/api/courses/match \
  -H "Content-Type: application/json" \
  -d '{
    "goal": "æœºå™¨å­¦ä¹ ",
    "skills": ["python", "æ•°å­¦"],
    "resume": "å¯¹ AI æ„Ÿå…´è¶£",
    "schedule": []
  }'
```

---

## ğŸ³ Docker æ„å»ºå’Œæµ‹è¯•

### æ„å»ºé•œåƒ:

```bash
docker build -t course-pilot-backend .
```

### æœ¬åœ°è¿è¡Œ:

```bash
docker run -p 8080:8080 \
  -e GROQ_API_KEY="your_groq_api_key_here" \
  course-pilot-backend
```

---

## â˜ï¸ Google Cloud Run éƒ¨ç½²

### å‰ç½®è¦æ±‚

1. å®‰è£… Google Cloud SDK: https://cloud.google.com/sdk/docs/install
2. è®¤è¯: `gcloud auth login`
3. è®¾ç½®é¡¹ç›®: `gcloud config set project ä½ çš„é¡¹ç›®ID`

### éƒ¨ç½²æ­¥éª¤

1. **æ„å»ºå¹¶æ¨é€åˆ° Google Container Registry:**

```bash
# è®¾ç½®ä½ çš„é¡¹ç›® ID
export PROJECT_ID=ä½ çš„-gcp-é¡¹ç›®-id

# æ„å»ºå’Œæ ‡è®°
docker build -t gcr.io/$PROJECT_ID/course-pilot-backend .

# æ¨é€åˆ° GCR
docker push gcr.io/$PROJECT_ID/course-pilot-backend
```

2. **éƒ¨ç½²åˆ° Cloud Run:**

```bash
gcloud run deploy course-pilot-backend \
  --image gcr.io/$PROJECT_ID/course-pilot-backend \
  --platform managed \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars GROQ_API_KEY="your_groq_api_key_here" \
  --memory 2Gi \
  --cpu 2 \
  --timeout 300
```

3. **è·å–æœåŠ¡ URL:**

```bash
gcloud run services describe course-pilot-backend \
  --platform managed \
  --region us-central1 \
  --format 'value(status.url)'
```

4. **æ›´æ–° Chrome Extension:**

æ›´æ–°æ‰©å±•çš„ API ç«¯ç‚¹ä¸º Cloud Run URL:
```javascript
const API_BASE_URL = 'https://course-pilot-backend-xxxxx-uc.a.run.app';
```

---

## ğŸ”§ é…ç½®

### ç¯å¢ƒå˜é‡

| å˜é‡ | å¿…éœ€ | é»˜è®¤å€¼ | æè¿° |
|-----|------|--------|------|
| `GROQ_API_KEY` | æ˜¯ | - | Groq API å¯†é’¥ç”¨äº LLM æ¨ç† |
| `PORT` | å¦ | 8080 | æœåŠ¡å™¨ç«¯å£ (Cloud Run ä¼šè¦†ç›–) |

### èµ„æºè¦æ±‚

- **å†…å­˜**: æ¨è 2GB (ChromaDB + åµŒå…¥)
- **CPU**: æ¨è 2 vCPU
- **ç£ç›˜**: ChromaDB æŒä¹…åŒ–å­˜å‚¨ (çº¦ 500MB)
- **å†·å¯åŠ¨**: çº¦ 10-15 ç§’ (é¦–æ¬¡è¯·æ±‚åˆå§‹åŒ–å‘é‡æ•°æ®åº“)

---

## ğŸ§ª æµ‹è¯•æ··åˆæœç´¢

### ç¤ºä¾‹ 1: è¯­ä¹‰æœç´¢

**æŸ¥è¯¢:** "æˆ‘æƒ³å­¦ä¹ äººå·¥æ™ºèƒ½"

**ç»“æœ:** è¿”å›å…³äº MLã€AIã€ç¥ç»ç½‘ç»œã€æ·±åº¦å­¦ä¹ çš„è¯¾ç¨‹ (å‘é‡ç›¸ä¼¼åº¦)

### ç¤ºä¾‹ 2: ç²¾ç¡®è¯¾ç¨‹ ID

**æŸ¥è¯¢:** "15-112"

**ç»“æœ:** è¿”å› "15-112 ç¼–ç¨‹åŸºç¡€" ä½œä¸ºé¦–é€‰ç»“æœ (å…³é”®è¯æå‡)

### ç¤ºä¾‹ 3: æ—¶é—´è¡¨è¿‡æ»¤

**æŸ¥è¯¢:** "æœºå™¨å­¦ä¹ " + æ—¶é—´è¡¨ `[{day: "M", times: ["9:00 AM", "9:30 AM"]}]`

**ç»“æœ:** ä»…è¿”å›å‘¨ä¸€ 9:00-9:30 AM çš„ ML è¯¾ç¨‹

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **å‘é‡æœç´¢**: çº¦ 50-100ms (ChromaDB æŸ¥è¯¢)
- **å…³é”®è¯åŒ¹é…**: çº¦ 1-5ms
- **Groq LLM**: çº¦ 200-500ms (æ‘˜è¦ç”Ÿæˆ)
- **æ€»å»¶è¿Ÿ**: çº¦ 300-600ms æ¯æ¬¡è¯·æ±‚

---

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **CORS**: ç›®å‰è®¾ç½®ä¸º `*` ç”¨äºå¼€å‘ã€‚ç”Ÿäº§ç¯å¢ƒæ›´æ–°ä¸º:
   ```python
   CORS(app, origins=["chrome-extension://ä½ çš„æ‰©å±•ID"])
   ```

2. **API å¯†é’¥**: å°† `GROQ_API_KEY` å­˜å‚¨ä¸º Cloud Run å¯†é’¥:
   ```bash
   echo -n "ä½ çš„å¯†é’¥" | gcloud secrets create groq-api-key --data-file=-
   ```

3. **é€Ÿç‡é™åˆ¶**: è€ƒè™‘ä¸ºç”Ÿäº§ç¯å¢ƒæ·»åŠ é€Ÿç‡é™åˆ¶

---

## ğŸ› æ•…éšœæ’é™¤

### ChromaDB æœªåˆå§‹åŒ–
- æ£€æŸ¥ç£ç›˜ç©ºé—´
- ç¡®ä¿å¯¹ `backend/chroma_db/` æœ‰å†™æƒé™
- åˆ é™¤ `chroma_db/` æ–‡ä»¶å¤¹å¹¶é‡å¯ä»¥é‡å»ºç´¢å¼•

### Groq API é”™è¯¯
- éªŒè¯ API å¯†é’¥æ­£ç¡®
- æ£€æŸ¥ Groq API çŠ¶æ€: https://status.groq.com/
- æŸ¥çœ‹é€Ÿç‡é™åˆ¶: https://console.groq.com/settings/limits

### åŒ¹é…åˆ†æ•°ä½
- è°ƒæ•´ `llm-proxy.py` ä¸­çš„æƒé‡:
  ```python
  VECTOR_WEIGHT = 0.7  # å¢åŠ ä»¥è·å¾—æ›´å¤šè¯­ä¹‰åŒ¹é…
  KEYWORD_WEIGHT = 0.3  # å¢åŠ ä»¥è·å¾—æ›´å¤šç²¾ç¡®åŒ¹é…
  ```

---

## ğŸ“ ä¸‹ä¸€æ­¥

1. âœ… åç«¯é‡æ„ä¸ºæ··åˆ RAG
2. âœ… Dockerfile å·²åˆ›å»º
3. âœ… Cloud Run å°±ç»ª
4. ğŸ”² æ›´æ–° Chrome Extension API ç«¯ç‚¹
5. ğŸ”² éƒ¨ç½²åˆ° Cloud Run
6. ğŸ”² æµ‹è¯•ç«¯åˆ°ç«¯æµç¨‹
7. ğŸ”² ç›‘æ§æ€§èƒ½å¹¶è°ƒæ•´æƒé‡

---

## ğŸ“š å…¶ä»–èµ„æº

- [ChromaDB æ–‡æ¡£](https://docs.trychroma.com/)
- [Groq API æ–‡æ¡£](https://console.groq.com/docs)
- [Google Cloud Run æ–‡æ¡£](https://cloud.google.com/run/docs)
- [Sentence Transformers](https://www.sbert.net/)
